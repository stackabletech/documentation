data:
  trino.rego: |
    package trino

    default allow = false

    allow if {
      is_alice
    }

    batch contains i if {
      some i
      input.action.filterResources[i]
      is_alice
    }

    batch contains i if {
      some i
      input.action.operation == "FilterColumns"
      count(input.action.filterResources) == 1
      input.action.filterResources[0].table.columns[i]
      is_alice
    }

    is_alice() if {
      input.context.identity.user == "alice"
    }
